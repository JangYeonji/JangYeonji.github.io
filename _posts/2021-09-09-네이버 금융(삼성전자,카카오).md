### -----------------------------------------------------------------------------------------------------------------기본값


```python
import pandas as pd
```


```python
import requests
```


```python
head = {
    "user-agent": 
    "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38"}
```

###  

### -----------------------------------------------------------------------------------------------------------------삼성전자


```python
r = requests.get("https://finance.naver.com/item/sise_day.nhn?code=005930&page=10", headers=head)   #code=종목
```


```python
삼전 = pd.read_html(r.text)[0].dropna().iloc[::-1]   #html > Series > DataFrame > 결측치제거 > 역순
```


```python
삼전
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>종가</th>
      <th>전일비</th>
      <th>시가</th>
      <th>고가</th>
      <th>저가</th>
      <th>거래량</th>
      <th>전날</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>2021.04.20</td>
      <td>83900.0</td>
      <td>600.0</td>
      <td>83300.0</td>
      <td>84000.0</td>
      <td>83100.0</td>
      <td>15521965.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2021.04.21</td>
      <td>82600.0</td>
      <td>1300.0</td>
      <td>83300.0</td>
      <td>83500.0</td>
      <td>82500.0</td>
      <td>21636079.0</td>
      <td>83900.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2021.04.22</td>
      <td>82400.0</td>
      <td>200.0</td>
      <td>82900.0</td>
      <td>83000.0</td>
      <td>82400.0</td>
      <td>13934746.0</td>
      <td>82600.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2021.04.23</td>
      <td>82800.0</td>
      <td>400.0</td>
      <td>81900.0</td>
      <td>82900.0</td>
      <td>81600.0</td>
      <td>17805080.0</td>
      <td>82400.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2021.04.26</td>
      <td>83500.0</td>
      <td>700.0</td>
      <td>82900.0</td>
      <td>83500.0</td>
      <td>82600.0</td>
      <td>15489938.0</td>
      <td>82800.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021.04.27</td>
      <td>82900.0</td>
      <td>600.0</td>
      <td>83200.0</td>
      <td>83300.0</td>
      <td>82500.0</td>
      <td>12941533.0</td>
      <td>83500.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021.04.28</td>
      <td>82100.0</td>
      <td>800.0</td>
      <td>83200.0</td>
      <td>83200.0</td>
      <td>82100.0</td>
      <td>15596759.0</td>
      <td>82900.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021.04.29</td>
      <td>81700.0</td>
      <td>400.0</td>
      <td>82400.0</td>
      <td>82500.0</td>
      <td>81500.0</td>
      <td>20000973.0</td>
      <td>82100.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021.04.30</td>
      <td>81500.0</td>
      <td>200.0</td>
      <td>81900.0</td>
      <td>82100.0</td>
      <td>81500.0</td>
      <td>18673197.0</td>
      <td>81700.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021.05.03</td>
      <td>81700.0</td>
      <td>200.0</td>
      <td>81000.0</td>
      <td>82400.0</td>
      <td>81000.0</td>
      <td>15710336.0</td>
      <td>81500.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
삼전['전날'] = 삼전.종가.shift(1)   #종가의 값을 하나씩 내림. 따라서 맨 위는 결측값
```


```python
삼전['차이'] = 삼전['종가'] - 삼전['전날'] 
삼전['상하락'] = 삼전.차이.apply(lambda x : True if x > 0 else False)
```


```python
삼전['상하락'] = 삼전[['종가', '전날']].apply(lambda x : True if x[0] - x[1] > 0 else False, axis=1)   #위 코드와 같음
```


```python
삼전.dropna()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>종가</th>
      <th>전일비</th>
      <th>시가</th>
      <th>고가</th>
      <th>저가</th>
      <th>거래량</th>
      <th>전날</th>
      <th>차이</th>
      <th>상하락</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>2021.04.21</td>
      <td>82600.0</td>
      <td>1300.0</td>
      <td>83300.0</td>
      <td>83500.0</td>
      <td>82500.0</td>
      <td>21636079.0</td>
      <td>83900.0</td>
      <td>-1300.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2021.04.22</td>
      <td>82400.0</td>
      <td>200.0</td>
      <td>82900.0</td>
      <td>83000.0</td>
      <td>82400.0</td>
      <td>13934746.0</td>
      <td>82600.0</td>
      <td>-200.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2021.04.23</td>
      <td>82800.0</td>
      <td>400.0</td>
      <td>81900.0</td>
      <td>82900.0</td>
      <td>81600.0</td>
      <td>17805080.0</td>
      <td>82400.0</td>
      <td>400.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2021.04.26</td>
      <td>83500.0</td>
      <td>700.0</td>
      <td>82900.0</td>
      <td>83500.0</td>
      <td>82600.0</td>
      <td>15489938.0</td>
      <td>82800.0</td>
      <td>700.0</td>
      <td>True</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021.04.27</td>
      <td>82900.0</td>
      <td>600.0</td>
      <td>83200.0</td>
      <td>83300.0</td>
      <td>82500.0</td>
      <td>12941533.0</td>
      <td>83500.0</td>
      <td>-600.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021.04.28</td>
      <td>82100.0</td>
      <td>800.0</td>
      <td>83200.0</td>
      <td>83200.0</td>
      <td>82100.0</td>
      <td>15596759.0</td>
      <td>82900.0</td>
      <td>-800.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021.04.29</td>
      <td>81700.0</td>
      <td>400.0</td>
      <td>82400.0</td>
      <td>82500.0</td>
      <td>81500.0</td>
      <td>20000973.0</td>
      <td>82100.0</td>
      <td>-400.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021.04.30</td>
      <td>81500.0</td>
      <td>200.0</td>
      <td>81900.0</td>
      <td>82100.0</td>
      <td>81500.0</td>
      <td>18673197.0</td>
      <td>81700.0</td>
      <td>-200.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021.05.03</td>
      <td>81700.0</td>
      <td>200.0</td>
      <td>81000.0</td>
      <td>82400.0</td>
      <td>81000.0</td>
      <td>15710336.0</td>
      <td>81500.0</td>
      <td>200.0</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>



### 

### -----------------------------------------------------------------------------------------------------------------카카오


```python
url = "https://finance.naver.com/item/sise_day.nhn?code={}&page={}"
```


```python
%%time
카카오 = []
for x in range(1, 20):
    r = requests.get(url.format('035720', x), headers=head)
    tmp = pd.read_html(r.text)[0].dropna()
    tmp['code'] = '035720'
    카카오.append(tmp)
```

    Wall time: 797 ms
    


```python
카카오
```




    [            날짜        종가      전일비        시가        고가        저가         거래량  \
     1   2021.09.09  128500.0  10000.0  134000.0  134500.0  128000.0  14249597.0   
     2   2021.09.08  138500.0  15500.0  151500.0  151500.0  136500.0  16920382.0   
     3   2021.09.07  154000.0   1500.0  155500.0  156000.0  153500.0   1072249.0   
     4   2021.09.06  155500.0   1000.0  156000.0  156500.0  152500.0   1883428.0   
     5   2021.09.03  156500.0   1500.0  155500.0  157500.0  154500.0   1934669.0   
     9   2021.09.02  155000.0   1000.0  154500.0  156000.0  153500.0   1649156.0   
     10  2021.09.01  154000.0   1000.0  155000.0  156000.0  154000.0   2011434.0   
     11  2021.08.31  155000.0   3500.0  152500.0  155000.0  151000.0   3078357.0   
     12  2021.08.30  151500.0   1500.0  152000.0  153000.0  150500.0   1628144.0   
     13  2021.08.27  150000.0    500.0  149000.0  150000.0  147000.0   1430634.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가     전일비        시가        고가        저가        거래량  \
     1   2021.08.26  149500.0  1500.0  151500.0  152500.0  147500.0  2360164.0   
     2   2021.08.25  151000.0  2000.0  149000.0  153500.0  148500.0  2900928.0   
     3   2021.08.24  149000.0   500.0  150000.0  150500.0  148000.0  2032632.0   
     4   2021.08.23  148500.0  4500.0  146000.0  148500.0  144500.0  2678395.0   
     5   2021.08.20  144000.0  2500.0  146500.0  149000.0  143000.0  2776813.0   
     9   2021.08.19  146500.0  1000.0  144000.0  149000.0  144000.0  2813914.0   
     10  2021.08.18  145500.0  3500.0  142000.0  146500.0  141500.0  2720552.0   
     11  2021.08.17  142000.0  4000.0  146000.0  147500.0  141000.0  3322347.0   
     12  2021.08.13  146000.0  1500.0  147500.0  147500.0  144500.0  2285992.0   
     13  2021.08.12  147500.0  3500.0  146000.0  148000.0  144000.0  2950088.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가     전일비        시가        고가        저가        거래량  \
     1   2021.08.11  144000.0  2500.0  145500.0  147500.0  144000.0  1754472.0   
     2   2021.08.10  146500.0  1500.0  148000.0  148500.0  144500.0  2074409.0   
     3   2021.08.09  148000.0  2500.0  145500.0  149000.0  144000.0  3017396.0   
     4   2021.08.06  145500.0  3500.0  149500.0  149500.0  145000.0  4155669.0   
     5   2021.08.05  149000.0   500.0  150000.0  151500.0  148500.0  2254087.0   
     9   2021.08.04  149500.0  5500.0  144500.0  150000.0  144000.0  3136752.0   
     10  2021.08.03  144000.0  2000.0  146000.0  146500.0  143000.0  2697098.0   
     11  2021.08.02  146000.0  1000.0  147000.0  148500.0  145000.0  2172117.0   
     12  2021.07.30  147000.0  1500.0  149000.0  149500.0  147000.0  2057332.0   
     13  2021.07.29  148500.0   500.0  148500.0  149000.0  147500.0  1766172.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가     전일비        시가        고가        저가         거래량  \
     1   2021.07.28  148000.0     0.0  147000.0  149500.0  146500.0   2716816.0   
     2   2021.07.27  148000.0   500.0  147500.0  149000.0  145500.0   3357695.0   
     3   2021.07.26  147500.0  2000.0  151500.0  153000.0  146500.0   4071898.0   
     4   2021.07.23  149500.0  2000.0  148500.0  153500.0  147500.0   5249906.0   
     5   2021.07.22  147500.0  2500.0  144500.0  148000.0  142500.0   5759268.0   
     9   2021.07.21  145000.0  7000.0  153000.0  155500.0  144500.0  10409836.0   
     10  2021.07.20  152000.0  2000.0  151500.0  153000.0  149000.0   6652856.0   
     11  2021.07.19  154000.0  3000.0  155500.0  155500.0  154000.0   3475792.0   
     12  2021.07.16  157000.0  2500.0  158500.0  159500.0  157000.0   3423188.0   
     13  2021.07.15  159500.0  2500.0  162000.0  162000.0  158500.0   3821843.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가     전일비        시가        고가        저가        거래량  \
     1   2021.07.14  162000.0  1000.0  161500.0  164500.0  161000.0  3352019.0   
     2   2021.07.13  161000.0  1000.0  162500.0  163500.0  160500.0  3859736.0   
     3   2021.07.12  162000.0  1500.0  161000.0  162500.0  158000.0  3248064.0   
     4   2021.07.09  160500.0  2500.0  161500.0  162000.0  158500.0  3795528.0   
     5   2021.07.08  163000.0  2000.0  161500.0  164500.0  161000.0  4121257.0   
     9   2021.07.07  161000.0  3500.0  158500.0  163500.0  158500.0  4413394.0   
     10  2021.07.06  157500.0   500.0  157500.0  159000.0  157000.0  2045164.0   
     11  2021.07.05  157000.0  2500.0  160500.0  162000.0  156500.0  4506967.0   
     12  2021.07.02  159500.0   500.0  158500.0  161500.0  156000.0  4407703.0   
     13  2021.07.01  160000.0  3000.0  164000.0  165500.0  159500.0  4630280.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가      전일비        시가        고가        저가         거래량  \
     1   2021.06.30  163000.0   5000.0  159000.0  165000.0  157500.0   7305590.0   
     2   2021.06.29  158000.0   3000.0  156000.0  158000.0  154500.0   3938542.0   
     3   2021.06.28  155000.0    500.0  154500.0  157500.0  154000.0   5141409.0   
     4   2021.06.25  154500.0   2500.0  155000.0  159500.0  150500.0  12271446.0   
     5   2021.06.24  157000.0  12500.0  172000.0  173000.0  155500.0  18408195.0   
     9   2021.06.23  169500.0  10500.0  162500.0  170000.0  161000.0   9078797.0   
     10  2021.06.22  159000.0   4000.0  158000.0  159000.0  155500.0   4662042.0   
     11  2021.06.21  155000.0      0.0  155500.0  159500.0  152000.0   8324948.0   
     12  2021.06.18  155000.0   7000.0  150000.0  157500.0  149500.0   7706345.0   
     13  2021.06.17  148000.0   5000.0  142000.0  149500.0  140500.0   5408889.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가     전일비        시가        고가        저가        거래량  \
     1   2021.06.16  143000.0  1500.0  144000.0  146000.0  142500.0  4996272.0   
     2   2021.06.15  144500.0  2000.0  143500.0  144500.0  140500.0  4950329.0   
     3   2021.06.14  142500.0  7000.0  136000.0  143000.0  136000.0  6240394.0   
     4   2021.06.11  135500.0  2000.0  134500.0  136500.0  132000.0  3674400.0   
     5   2021.06.10  133500.0  4500.0  130000.0  135000.0  129500.0  5564011.0   
     9   2021.06.09  129000.0   500.0  128500.0  130000.0  128500.0  1936747.0   
     10  2021.06.08  128500.0  2500.0  127000.0  128500.0  126500.0  2248373.0   
     11  2021.06.07  126000.0  2000.0  125000.0  127000.0  125000.0  1905198.0   
     12  2021.06.04  124000.0  2500.0  126000.0  126000.0  123000.0  2668254.0   
     13  2021.06.03  126500.0   500.0  127500.0  128500.0  126000.0  1737466.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가     전일비        시가        고가        저가        거래량  \
     1   2021.06.02  127000.0     0.0  128000.0  129500.0  126000.0  2597446.0   
     2   2021.06.01  127000.0  4000.0  123500.0  127000.0  123000.0  3573808.0   
     3   2021.05.31  123000.0  1000.0  122000.0  123000.0  120500.0  2299358.0   
     4   2021.05.28  122000.0  3000.0  125000.0  125500.0  120500.0  3685820.0   
     5   2021.05.27  125000.0  5500.0  120000.0  125000.0  119500.0  7398732.0   
     9   2021.05.26  119500.0  1500.0  118500.0  120000.0  117500.0  2308405.0   
     10  2021.05.25  118000.0  1500.0  117000.0  118000.0  116000.0  1777001.0   
     11  2021.05.24  116500.0   500.0  116500.0  118000.0  115500.0  1715308.0   
     12  2021.05.21  117000.0  3500.0  116000.0  119000.0  114500.0  3018548.0   
     13  2021.05.20  113500.0   500.0  112500.0  115500.0  112000.0  2135101.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가     전일비        시가        고가        저가        거래량  \
     1   2021.05.18  113000.0  2500.0  111500.0  114500.0  111000.0  1585701.0   
     2   2021.05.17  110500.0  1500.0  109000.0  111000.0  109000.0  1656454.0   
     3   2021.05.14  109000.0   500.0  109500.0  111500.0  108000.0  2276082.0   
     4   2021.05.13  109500.0  3500.0  109000.0  111000.0  108000.0  4201490.0   
     5   2021.05.12  113000.0  1500.0  115000.0  115500.0  112000.0  2558482.0   
     9   2021.05.11  114500.0  1500.0  115000.0  117000.0  114500.0  1875600.0   
     10  2021.05.10  116000.0  1500.0  115500.0  116500.0  114500.0  1898994.0   
     11  2021.05.07  114500.0   500.0  115500.0  117000.0  114000.0  2040844.0   
     12  2021.05.06  115000.0   500.0  115000.0  117500.0  113500.0  3234424.0   
     13  2021.05.04  115500.0  1000.0  113500.0  116000.0  112000.0  2228466.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가     전일비        시가        고가        저가        거래량  \
     1   2021.05.03  114500.0  1000.0  112500.0  116000.0  110000.0  2832622.0   
     2   2021.04.30  113500.0  3500.0  117000.0  117000.0  113000.0  4405688.0   
     3   2021.04.29  117000.0  2500.0  120000.0  120500.0  115500.0  3445462.0   
     4   2021.04.28  119500.0  2000.0  121500.0  122000.0  119000.0  2276272.0   
     5   2021.04.27  121500.0  3500.0  118500.0  124500.0  118500.0  5332544.0   
     9   2021.04.26  118000.0   500.0  118000.0  118000.0  117500.0  1729458.0   
     10  2021.04.23  117500.0     0.0  116500.0  118500.0  114500.0  2473720.0   
     11  2021.04.22  117500.0   500.0  118000.0  119500.0  117500.0  2279180.0   
     12  2021.04.21  118000.0  1500.0  119500.0  119500.0  117000.0  4461636.0   
     13  2021.04.20  119500.0   500.0  119000.0  121000.0  118000.0  2952174.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가      전일비        시가        고가        저가         거래량  \
     1   2021.04.19  119000.0      0.0  120000.0  122000.0  117500.0   5441693.0   
     2   2021.04.16  119000.0   1500.0  115500.0  120500.0  115500.0  13709555.0   
     3   2021.04.15  120500.0   8500.0  120500.0  132500.0  118000.0  17115015.0   
     4   2021.04.14  558000.0      0.0       0.0       0.0       0.0         0.0   
     5   2021.04.13  558000.0      0.0       0.0       0.0       0.0         0.0   
     9   2021.04.12  558000.0      0.0       0.0       0.0       0.0         0.0   
     10  2021.04.09  558000.0  10000.0  554000.0  561000.0  551000.0    788839.0   
     11  2021.04.08  548000.0   6000.0  539000.0  561000.0  534000.0    912514.0   
     12  2021.04.07  542000.0   2000.0  544000.0  544000.0  526000.0    820896.0   
     13  2021.04.06  544000.0  42000.0  506000.0  545000.0  505000.0   1724958.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가      전일비        시가        고가        저가       거래량  \
     1   2021.04.05  502000.0   1000.0  503000.0  505000.0  500000.0  310400.0   
     2   2021.04.02  501000.0   2000.0  508000.0  508000.0  499000.0  298641.0   
     3   2021.04.01  499000.0   1000.0  500000.0  504000.0  492000.0  412423.0   
     4   2021.03.31  498000.0   4500.0  494000.0  505000.0  491000.0  503036.0   
     5   2021.03.30  493500.0   6000.0  490000.0  497000.0  489500.0  311073.0   
     9   2021.03.29  487500.0   7500.0  496000.0  496500.0  485000.0  349113.0   
     10  2021.03.26  495000.0  10000.0  488000.0  495000.0  486000.0  384547.0   
     11  2021.03.25  485000.0   7000.0  490000.0  491000.0  482000.0  388531.0   
     12  2021.03.24  492000.0   1500.0  486500.0  492000.0  482000.0  288563.0   
     13  2021.03.23  490500.0   3500.0  496000.0  503000.0  485500.0  379964.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가      전일비        시가        고가        저가        거래량  \
     1   2021.03.22  494000.0   1500.0  493000.0  496500.0  488000.0   315035.0   
     2   2021.03.19  492500.0   5500.0  488500.0  497000.0  484000.0   516981.0   
     3   2021.03.18  498000.0  13000.0  488500.0  504000.0  486000.0   771697.0   
     4   2021.03.17  485000.0   6000.0  479000.0  491000.0  478000.0   403953.0   
     5   2021.03.16  479000.0      0.0  481000.0  485000.0  478000.0   270853.0   
     9   2021.03.15  479000.0   2000.0  480000.0  482000.0  472000.0   345981.0   
     10  2021.03.12  481000.0   2000.0  489000.0  490000.0  477000.0   435063.0   
     11  2021.03.11  479000.0  19000.0  460500.0  484500.0  457000.0   928091.0   
     12  2021.03.10  460000.0  19000.0  452500.0  464500.0  449000.0   899669.0   
     13  2021.03.09  441000.0  13000.0  448500.0  451500.0  434500.0  1068670.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가      전일비        시가        고가        저가        거래량  \
     1   2021.03.08  454000.0  17000.0  472000.0  474500.0  454000.0   681524.0   
     2   2021.03.05  471000.0  11000.0  469000.0  474000.0  463000.0   712633.0   
     3   2021.03.04  482000.0  11500.0  487500.0  490000.0  481000.0   694890.0   
     4   2021.03.03  493500.0   2000.0  490500.0  495000.0  488000.0   528321.0   
     5   2021.03.02  491500.0   3500.0  499000.0  504000.0  490000.0   922034.0   
     9   2021.02.26  488000.0   3500.0  497500.0  502000.0  480500.0  1617276.0   
     10  2021.02.25  484500.0  11000.0  478000.0  484500.0  473500.0   562549.0   
     11  2021.02.24  473500.0  13500.0  487000.0  492500.0  472500.0   667209.0   
     12  2021.02.23  487000.0   3500.0  481500.0  492500.0  477000.0   665417.0   
     13  2021.02.22  490500.0  13500.0  505000.0  510000.0  490000.0   640993.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가      전일비        시가        고가        저가        거래량  \
     1   2021.02.19  504000.0   3000.0  497000.0  506000.0  490000.0   695664.0   
     2   2021.02.18  501000.0   8000.0  506000.0  517000.0  501000.0   466922.0   
     3   2021.02.17  509000.0   5000.0  515000.0  515000.0  503000.0   562572.0   
     4   2021.02.16  514000.0  12000.0  504000.0  519000.0  499500.0  1076048.0   
     5   2021.02.15  502000.0  12500.0  499000.0  505000.0  492000.0  1052548.0   
     9   2021.02.10  489500.0  28500.0  466000.0  490500.0  466000.0  1814483.0   
     10  2021.02.09  461000.0   4000.0  460000.0  467500.0  452500.0   735565.0   
     11  2021.02.08  457000.0   2000.0  455000.0  462000.0  450000.0   516115.0   
     12  2021.02.05  455000.0    500.0  457000.0  461000.0  447500.0   408416.0   
     13  2021.02.04  454500.0   7500.0  463000.0  463000.0  449000.0   516837.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가      전일비        시가        고가        저가        거래량  \
     1   2021.02.03  462000.0  16500.0  450500.0  462000.0  447000.0   758097.0   
     2   2021.02.02  445500.0   4000.0  450000.0  457000.0  443500.0   662905.0   
     3   2021.02.01  441500.0    500.0  436000.0  443000.0  425000.0   910101.0   
     4   2021.01.29  441000.0  17000.0  460000.0  460500.0  436000.0  1070093.0   
     5   2021.01.28  458000.0   7000.0  454000.0  468500.0  452000.0   921812.0   
     9   2021.01.27  465000.0   4000.0  463000.0  477000.0  461000.0   719814.0   
     10  2021.01.26  461000.0  12500.0  479000.0  479000.0  460500.0   812266.0   
     11  2021.01.25  473500.0  10500.0  472000.0  475500.0  460000.0   720170.0   
     12  2021.01.22  463000.0   9000.0  456000.0  476000.0  452500.0  1162395.0   
     13  2021.01.21  454000.0  10000.0  452500.0  461000.0  452000.0   679093.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가      전일비        시가        고가        저가        거래량  \
     1   2021.01.20  444000.0   4000.0  448000.0  450000.0  437000.0   596340.0   
     2   2021.01.19  440000.0  12500.0  428000.0  444500.0  428000.0   583997.0   
     3   2021.01.18  427500.0  10000.0  433500.0  441500.0  427000.0   839984.0   
     4   2021.01.15  437500.0  14000.0  452000.0  459000.0  436500.0   995726.0   
     5   2021.01.14  451500.0   3000.0  454000.0  463000.0  450000.0   802076.0   
     9   2021.01.13  454500.0   3000.0  458500.0  462000.0  449500.0   806402.0   
     10  2021.01.12  457500.0   4500.0  446000.0  460000.0  433000.0  1577872.0   
     11  2021.01.11  453000.0  19000.0  441000.0  463000.0  429000.0  3157747.0   
     12  2021.01.08  434000.0  31500.0  413000.0  436000.0  404500.0  2466715.0   
     13  2021.01.07  402500.0   7000.0  402000.0  403500.0  393000.0   775191.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가      전일비        시가        고가        저가        거래량  \
     1   2021.01.06  395500.0   2500.0  395000.0  410000.0  394500.0  1435715.0   
     2   2021.01.05  393000.0   3000.0  393000.0  395500.0  387000.0   748559.0   
     3   2021.01.04  396000.0   6500.0  392000.0  396500.0  385500.0   853740.0   
     4   2020.12.30  389500.0   5000.0  384500.0  394000.0  383500.0   813142.0   
     5   2020.12.29  384500.0  11500.0  381000.0  385500.0  378000.0   857404.0   
     9   2020.12.28  373000.0   1000.0  374500.0  377000.0  369500.0   646464.0   
     10  2020.12.24  374000.0   3500.0  378500.0  380000.0  372000.0   465132.0   
     11  2020.12.23  377500.0   1500.0  381000.0  385500.0  377000.0   629952.0   
     12  2020.12.22  376000.0   3500.0  380000.0  389500.0  375500.0   876516.0   
     13  2020.12.21  379500.0  12500.0  367000.0  380000.0  367000.0   819879.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ,
                 날짜        종가      전일비        시가        고가        저가       거래량  \
     1   2020.12.18  367000.0   2000.0  369000.0  369500.0  365500.0  427433.0   
     2   2020.12.17  369000.0   3000.0  374000.0  374000.0  368500.0  455131.0   
     3   2020.12.16  372000.0   1000.0  373500.0  375000.0  371000.0  269253.0   
     4   2020.12.15  371000.0   2500.0  373500.0  375500.0  369000.0  393157.0   
     5   2020.12.14  373500.0   1000.0  376500.0  381000.0  372500.0  480288.0   
     9   2020.12.11  374500.0   4000.0  374000.0  380000.0  373000.0  438405.0   
     10  2020.12.10  370500.0   4500.0  371000.0  378000.0  367500.0  818557.0   
     11  2020.12.09  375000.0    500.0  375000.0  378000.0  373000.0  579905.0   
     12  2020.12.08  374500.0  10500.0  387500.0  388000.0  374000.0  768600.0   
     13  2020.12.07  385000.0   4500.0  395000.0  395000.0  380500.0  894743.0   
     
           code  
     1   035720  
     2   035720  
     3   035720  
     4   035720  
     5   035720  
     9   035720  
     10  035720  
     11  035720  
     12  035720  
     13  035720  ]




```python
cacao = pd.concat(카카오).iloc[::-1].copy()   #날짜를 최신순으로 하기 위해 역순설정함
```


```python
cacao
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>종가</th>
      <th>전일비</th>
      <th>시가</th>
      <th>고가</th>
      <th>저가</th>
      <th>거래량</th>
      <th>code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>2020.12.07</td>
      <td>385000.0</td>
      <td>4500.0</td>
      <td>395000.0</td>
      <td>395000.0</td>
      <td>380500.0</td>
      <td>894743.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2020.12.08</td>
      <td>374500.0</td>
      <td>10500.0</td>
      <td>387500.0</td>
      <td>388000.0</td>
      <td>374000.0</td>
      <td>768600.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2020.12.09</td>
      <td>375000.0</td>
      <td>500.0</td>
      <td>375000.0</td>
      <td>378000.0</td>
      <td>373000.0</td>
      <td>579905.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2020.12.10</td>
      <td>370500.0</td>
      <td>4500.0</td>
      <td>371000.0</td>
      <td>378000.0</td>
      <td>367500.0</td>
      <td>818557.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2020.12.11</td>
      <td>374500.0</td>
      <td>4000.0</td>
      <td>374000.0</td>
      <td>380000.0</td>
      <td>373000.0</td>
      <td>438405.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021.09.03</td>
      <td>156500.0</td>
      <td>1500.0</td>
      <td>155500.0</td>
      <td>157500.0</td>
      <td>154500.0</td>
      <td>1934669.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021.09.06</td>
      <td>155500.0</td>
      <td>1000.0</td>
      <td>156000.0</td>
      <td>156500.0</td>
      <td>152500.0</td>
      <td>1883428.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021.09.07</td>
      <td>154000.0</td>
      <td>1500.0</td>
      <td>155500.0</td>
      <td>156000.0</td>
      <td>153500.0</td>
      <td>1072249.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021.09.08</td>
      <td>138500.0</td>
      <td>15500.0</td>
      <td>151500.0</td>
      <td>151500.0</td>
      <td>136500.0</td>
      <td>16920382.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021.09.09</td>
      <td>128500.0</td>
      <td>10000.0</td>
      <td>134000.0</td>
      <td>134500.0</td>
      <td>128000.0</td>
      <td>14249597.0</td>
      <td>035720</td>
    </tr>
  </tbody>
</table>
<p>190 rows × 8 columns</p>
</div>




```python
cacao.reset_index(drop=True, inplace=True)   #날짜는 최신순으로 했으니, 인덱스만 리셋
```


```python
cacao
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>종가</th>
      <th>전일비</th>
      <th>시가</th>
      <th>고가</th>
      <th>저가</th>
      <th>거래량</th>
      <th>code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020.12.07</td>
      <td>385000.0</td>
      <td>4500.0</td>
      <td>395000.0</td>
      <td>395000.0</td>
      <td>380500.0</td>
      <td>894743.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020.12.08</td>
      <td>374500.0</td>
      <td>10500.0</td>
      <td>387500.0</td>
      <td>388000.0</td>
      <td>374000.0</td>
      <td>768600.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020.12.09</td>
      <td>375000.0</td>
      <td>500.0</td>
      <td>375000.0</td>
      <td>378000.0</td>
      <td>373000.0</td>
      <td>579905.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020.12.10</td>
      <td>370500.0</td>
      <td>4500.0</td>
      <td>371000.0</td>
      <td>378000.0</td>
      <td>367500.0</td>
      <td>818557.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020.12.11</td>
      <td>374500.0</td>
      <td>4000.0</td>
      <td>374000.0</td>
      <td>380000.0</td>
      <td>373000.0</td>
      <td>438405.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>185</th>
      <td>2021.09.03</td>
      <td>156500.0</td>
      <td>1500.0</td>
      <td>155500.0</td>
      <td>157500.0</td>
      <td>154500.0</td>
      <td>1934669.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>186</th>
      <td>2021.09.06</td>
      <td>155500.0</td>
      <td>1000.0</td>
      <td>156000.0</td>
      <td>156500.0</td>
      <td>152500.0</td>
      <td>1883428.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>187</th>
      <td>2021.09.07</td>
      <td>154000.0</td>
      <td>1500.0</td>
      <td>155500.0</td>
      <td>156000.0</td>
      <td>153500.0</td>
      <td>1072249.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>188</th>
      <td>2021.09.08</td>
      <td>138500.0</td>
      <td>15500.0</td>
      <td>151500.0</td>
      <td>151500.0</td>
      <td>136500.0</td>
      <td>16920382.0</td>
      <td>035720</td>
    </tr>
    <tr>
      <th>189</th>
      <td>2021.09.09</td>
      <td>128500.0</td>
      <td>10000.0</td>
      <td>134000.0</td>
      <td>134500.0</td>
      <td>128000.0</td>
      <td>14249597.0</td>
      <td>035720</td>
    </tr>
  </tbody>
</table>
<p>190 rows × 8 columns</p>
</div>




```python
cacao['MA15'] = cacao['종가'].rolling(15).mean()   #이동평균. 9월 3일은 9월3일전15일 ~ 9월3일의 값의 평균임
```


```python
cacao
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>종가</th>
      <th>전일비</th>
      <th>시가</th>
      <th>고가</th>
      <th>저가</th>
      <th>거래량</th>
      <th>code</th>
      <th>MA15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020.12.07</td>
      <td>385000.0</td>
      <td>4500.0</td>
      <td>395000.0</td>
      <td>395000.0</td>
      <td>380500.0</td>
      <td>894743.0</td>
      <td>035720</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020.12.08</td>
      <td>374500.0</td>
      <td>10500.0</td>
      <td>387500.0</td>
      <td>388000.0</td>
      <td>374000.0</td>
      <td>768600.0</td>
      <td>035720</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020.12.09</td>
      <td>375000.0</td>
      <td>500.0</td>
      <td>375000.0</td>
      <td>378000.0</td>
      <td>373000.0</td>
      <td>579905.0</td>
      <td>035720</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020.12.10</td>
      <td>370500.0</td>
      <td>4500.0</td>
      <td>371000.0</td>
      <td>378000.0</td>
      <td>367500.0</td>
      <td>818557.0</td>
      <td>035720</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020.12.11</td>
      <td>374500.0</td>
      <td>4000.0</td>
      <td>374000.0</td>
      <td>380000.0</td>
      <td>373000.0</td>
      <td>438405.0</td>
      <td>035720</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>185</th>
      <td>2021.09.03</td>
      <td>156500.0</td>
      <td>1500.0</td>
      <td>155500.0</td>
      <td>157500.0</td>
      <td>154500.0</td>
      <td>1934669.0</td>
      <td>035720</td>
      <td>149600.000000</td>
    </tr>
    <tr>
      <th>186</th>
      <td>2021.09.06</td>
      <td>155500.0</td>
      <td>1000.0</td>
      <td>156000.0</td>
      <td>156500.0</td>
      <td>152500.0</td>
      <td>1883428.0</td>
      <td>035720</td>
      <td>150233.333333</td>
    </tr>
    <tr>
      <th>187</th>
      <td>2021.09.07</td>
      <td>154000.0</td>
      <td>1500.0</td>
      <td>155500.0</td>
      <td>156000.0</td>
      <td>153500.0</td>
      <td>1072249.0</td>
      <td>035720</td>
      <td>151033.333333</td>
    </tr>
    <tr>
      <th>188</th>
      <td>2021.09.08</td>
      <td>138500.0</td>
      <td>15500.0</td>
      <td>151500.0</td>
      <td>151500.0</td>
      <td>136500.0</td>
      <td>16920382.0</td>
      <td>035720</td>
      <td>150566.666667</td>
    </tr>
    <tr>
      <th>189</th>
      <td>2021.09.09</td>
      <td>128500.0</td>
      <td>10000.0</td>
      <td>134000.0</td>
      <td>134500.0</td>
      <td>128000.0</td>
      <td>14249597.0</td>
      <td>035720</td>
      <td>149366.666667</td>
    </tr>
  </tbody>
</table>
<p>190 rows × 9 columns</p>
</div>




```python
cacao.dropna(inplace=True)
```


```python
cacao.iloc[::-1]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>종가</th>
      <th>전일비</th>
      <th>시가</th>
      <th>고가</th>
      <th>저가</th>
      <th>거래량</th>
      <th>code</th>
      <th>MA15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>189</th>
      <td>2021.09.09</td>
      <td>128500.0</td>
      <td>10000.0</td>
      <td>134000.0</td>
      <td>134500.0</td>
      <td>128000.0</td>
      <td>14249597.0</td>
      <td>035720</td>
      <td>149366.666667</td>
    </tr>
    <tr>
      <th>188</th>
      <td>2021.09.08</td>
      <td>138500.0</td>
      <td>15500.0</td>
      <td>151500.0</td>
      <td>151500.0</td>
      <td>136500.0</td>
      <td>16920382.0</td>
      <td>035720</td>
      <td>150566.666667</td>
    </tr>
    <tr>
      <th>187</th>
      <td>2021.09.07</td>
      <td>154000.0</td>
      <td>1500.0</td>
      <td>155500.0</td>
      <td>156000.0</td>
      <td>153500.0</td>
      <td>1072249.0</td>
      <td>035720</td>
      <td>151033.333333</td>
    </tr>
    <tr>
      <th>186</th>
      <td>2021.09.06</td>
      <td>155500.0</td>
      <td>1000.0</td>
      <td>156000.0</td>
      <td>156500.0</td>
      <td>152500.0</td>
      <td>1883428.0</td>
      <td>035720</td>
      <td>150233.333333</td>
    </tr>
    <tr>
      <th>185</th>
      <td>2021.09.03</td>
      <td>156500.0</td>
      <td>1500.0</td>
      <td>155500.0</td>
      <td>157500.0</td>
      <td>154500.0</td>
      <td>1934669.0</td>
      <td>035720</td>
      <td>149600.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2021.01.05</td>
      <td>393000.0</td>
      <td>3000.0</td>
      <td>393000.0</td>
      <td>395500.0</td>
      <td>387000.0</td>
      <td>748559.0</td>
      <td>035720</td>
      <td>378000.000000</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2021.01.04</td>
      <td>396000.0</td>
      <td>6500.0</td>
      <td>392000.0</td>
      <td>396500.0</td>
      <td>385500.0</td>
      <td>853740.0</td>
      <td>035720</td>
      <td>376500.000000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2020.12.30</td>
      <td>389500.0</td>
      <td>5000.0</td>
      <td>384500.0</td>
      <td>394000.0</td>
      <td>383500.0</td>
      <td>813142.0</td>
      <td>035720</td>
      <td>375100.000000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2020.12.29</td>
      <td>384500.0</td>
      <td>11500.0</td>
      <td>381000.0</td>
      <td>385500.0</td>
      <td>378000.0</td>
      <td>857404.0</td>
      <td>035720</td>
      <td>374100.000000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2020.12.28</td>
      <td>373000.0</td>
      <td>1000.0</td>
      <td>374500.0</td>
      <td>377000.0</td>
      <td>369500.0</td>
      <td>646464.0</td>
      <td>035720</td>
      <td>374133.333333</td>
    </tr>
  </tbody>
</table>
<p>176 rows × 9 columns</p>
</div>



### 

조건
1. 네이버 금융 > 종목별 일별시세 20페이지 pd로 만들기
2. 종목명, 종목코드, MA30는 함수로 입력받아서 데이터프레임으로 추출
3. MA 계산할때 날짜 정렬된 것을 확인하고 만들것 
4. 결측치는 제거 
5. 모든 DataFrame은 total_stock이라는 DataFrame 저장 


```python
def get_stock(code_, name_, page_, MA):
    url = "https://finance.naver.com/item/sise_day.nhn?code={}&page={}"
    head = {"user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38"}
    
    stock = []
    for x in range(1, page_+1):
        r = requests.get(url.format(code_, x), headers=head)
        tmp = pd.read_html(r.text)[0].dropna()
        tmp['종목코드'] = code_
        tmp['종목명'] = name_
        stock.append(tmp)
        
    total = pd.concat(stock)
    total = total.iloc[::-1].copy()
    total['MA{}'.format(MA)] = total['종가'].rolling(MA).mean()
    total.dropna(inplace=True)
    
    return total.reset_index(drop=True)
```


```python
rt = get_stock("005930", "삼성전자", 20, 20)
```


```python
rt
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>종가</th>
      <th>전일비</th>
      <th>시가</th>
      <th>고가</th>
      <th>저가</th>
      <th>거래량</th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>MA20</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020.12.18</td>
      <td>73000.0</td>
      <td>300.0</td>
      <td>73300.0</td>
      <td>73700.0</td>
      <td>73000.0</td>
      <td>17613029.0</td>
      <td>005930</td>
      <td>삼성전자</td>
      <td>70785.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020.12.21</td>
      <td>73000.0</td>
      <td>0.0</td>
      <td>73100.0</td>
      <td>73400.0</td>
      <td>72000.0</td>
      <td>20367355.0</td>
      <td>005930</td>
      <td>삼성전자</td>
      <td>71060.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020.12.22</td>
      <td>72300.0</td>
      <td>700.0</td>
      <td>72500.0</td>
      <td>73200.0</td>
      <td>72100.0</td>
      <td>16304910.0</td>
      <td>005930</td>
      <td>삼성전자</td>
      <td>71290.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020.12.23</td>
      <td>73900.0</td>
      <td>1600.0</td>
      <td>72400.0</td>
      <td>74000.0</td>
      <td>72300.0</td>
      <td>19411326.0</td>
      <td>005930</td>
      <td>삼성전자</td>
      <td>71655.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020.12.24</td>
      <td>77800.0</td>
      <td>3900.0</td>
      <td>74100.0</td>
      <td>78800.0</td>
      <td>74000.0</td>
      <td>32502870.0</td>
      <td>005930</td>
      <td>삼성전자</td>
      <td>72145.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>176</th>
      <td>2021.09.03</td>
      <td>76600.0</td>
      <td>600.0</td>
      <td>76400.0</td>
      <td>76700.0</td>
      <td>76000.0</td>
      <td>12096419.0</td>
      <td>005930</td>
      <td>삼성전자</td>
      <td>76060.0</td>
    </tr>
    <tr>
      <th>177</th>
      <td>2021.09.06</td>
      <td>77300.0</td>
      <td>700.0</td>
      <td>76800.0</td>
      <td>77600.0</td>
      <td>76600.0</td>
      <td>12861180.0</td>
      <td>005930</td>
      <td>삼성전자</td>
      <td>75850.0</td>
    </tr>
    <tr>
      <th>178</th>
      <td>2021.09.07</td>
      <td>76100.0</td>
      <td>1200.0</td>
      <td>77100.0</td>
      <td>77100.0</td>
      <td>75900.0</td>
      <td>13239401.0</td>
      <td>005930</td>
      <td>삼성전자</td>
      <td>75580.0</td>
    </tr>
    <tr>
      <th>179</th>
      <td>2021.09.08</td>
      <td>76300.0</td>
      <td>200.0</td>
      <td>76000.0</td>
      <td>76400.0</td>
      <td>75600.0</td>
      <td>11798147.0</td>
      <td>005930</td>
      <td>삼성전자</td>
      <td>75385.0</td>
    </tr>
    <tr>
      <th>180</th>
      <td>2021.09.09</td>
      <td>75300.0</td>
      <td>1000.0</td>
      <td>76400.0</td>
      <td>76600.0</td>
      <td>75000.0</td>
      <td>17507160.0</td>
      <td>005930</td>
      <td>삼성전자</td>
      <td>75225.0</td>
    </tr>
  </tbody>
</table>
<p>181 rows × 10 columns</p>
</div>


